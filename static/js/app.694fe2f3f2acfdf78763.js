webpackJsonp([1],{"4ZZD":function(t,e){},"6PWG":function(t,e){},"6l73":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var a=n("VU/8")({name:"App"},o,!1,function(t){n("uaGJ")},null,null).exports,s=n("/ocq"),l={data:function(){return{}},mounted:function(){this.init()},methods:{init:function(){jsPlumb.ready(function(){jsPlumb.setContainer("hwid");var t={isSource:!0,isTarget:!0,endpoint:"Dot",connector:["Bezier"],maxConnections:-1,anchor:"Continuous",paintStyle:{stroke:"green",strokeWidth:2},endpointStyle:{fill:"red",outlineStroke:"blue",outlineWidth:2},overlays:[["Arrow",{width:10,length:10,location:.5}]]};jsPlumb.addEndpoint("item_left",{},t),jsPlumb.addEndpoint("item_left",{},t),jsPlumb.addEndpoint("item_right",{},t),jsPlumb.draggable("item_left",{containment:"parent"}),jsPlumb.draggable("item_right",{containment:"parent"})})}}},r={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"hw",attrs:{id:"hwid"}},[e("div",{staticClass:"item",attrs:{id:"item_left"}}),this._v(" "),e("div",{staticClass:"item",staticStyle:{left:"100px"},attrs:{id:"item_right"}})])}]};var d=n("VU/8")(l,r,!1,function(t){n("4ZZD")},"data-v-8c0d889c",null).exports,c=n("w/TU"),u=n.n(c),m=[{id:1,name:"类型1",type:"type1",attrs:[{name:"name",title:"标签文本",default:"标签",type:"text"},{name:"state",title:"状态",default:"0",type:"select",option:[{value:"0",label:"禁用"},{value:"1",label:"启用"}]}]},{id:2,name:"类型2",type:"type2",attrs:[{name:"name",title:"标签文本",default:"标签",type:"text"}]},{id:3,name:"类型3",type:"type3",attrs:[{name:"name",title:"标签文本",default:"标签",type:"text"},{name:"icon",title:"图标",default:"el-icon-warning-outline",type:"text"}]}],p=n("mvHQ"),f=n.n(p);function h(){return Math.random().toString(36).substr(3,10)}function v(t){return JSON.parse(f()(t))}var b={components:{Draggable:u.a},data:function(){return{dragOptions:{sort:!1,disabled:!1,preventOnFilter:!1,ghostClass:"tt",forceFallback:!0},menuList:m,tmpNode:{}}},methods:{findMenuItem:function(t){for(var e=0;e<this.menuList.length;e++){var n=this.menuList[e];if(n.type==t)return v(n)}},start:function(t){var e=t.item.attributes.type.nodeValue;this.tmpNode=this.findMenuItem(e);for(var n=0;n<this.tmpNode.attrs.length;n++){var i=this.tmpNode.attrs[n];this.tmpNode[i.name]||(this.tmpNode[i.name]=i.default)}delete this.tmpNode.attrs,this.tmpNode.id=h(),this.tmpNode.width=t.item.clientWidth,this.tmpNode.height=t.item.clientHeight,console.log("start",this.tmpNode)},end:function(t,e){console.log("end"),this.$emit("addNode",t,this.tmpNode)}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node-menu"},[n("draggable",{attrs:{options:t.dragOptions},on:{start:t.start,end:t.end},model:{value:t.menuList,callback:function(e){t.menuList=e},expression:"menuList"}},t._l(t.menuList,function(e){return n("div",{key:e.id,staticClass:"menu-item",attrs:{type:e.type}},[t._v("\n      "+t._s(e.name)+"\n    ")])}),0)],1)},staticRenderFns:[]};var y=n("VU/8")(b,g,!1,function(t){n("UUFZ")},"data-v-26cb0b02",null).exports,L={props:{node:Object},computed:{nodeItemStyle:function(){return{top:this.node.top,left:this.node.left}}},methods:{changeNodePostion:function(){this.$emit("changeNodePostion",{nodeId:this.node.id,left:this.$refs.nodeRef.style.left,top:this.$refs.nodeRef.style.top})},nodeClick:function(){this.$emit("nodeClick",this.node)},nodeRightClick:function(t){this.$emit("nodeRightClick",t,this.node)}}},k={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"nodeRef",staticClass:"node-item",style:this.nodeItemStyle,on:{click:this.nodeClick,mouseup:this.changeNodePostion}},[e("div",{staticClass:"node-drag"}),this._v(" "),e("div",{staticClass:"node-name"},[this._v(this._s(this.node.name))])])},staticRenderFns:[]};var C=n("VU/8")(L,k,!1,function(t){n("uLYZ")},"data-v-b6eca470",null).exports,j={props:{form:Object,attrs:Array}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"form",staticClass:"form-auto",attrs:{model:t.form,"label-width":"80px",size:"mini"}},t._l(t.attrs,function(e){return n("el-form-item",{key:e.name,attrs:{label:e.title}},["text"==e.type?n("el-input",{staticClass:"attr-item",attrs:{disabled:e.disabled},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[attr.name]"}}):t._e(),t._v(" "),"select"==e.type?n("el-select",{staticClass:"attr-item",attrs:{disabled:e.disabled},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[attr.name]"}},t._l(e.option,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1):t._e()],1)}),1)},staticRenderFns:[]};var P=n("VU/8")(j,_,!1,function(t){n("6PWG")},"data-v-e62a9d6c",null).exports,x={props:{node:Object,line:Object,type:{type:String,default:"node"}},components:{FormAuto:P},computed:{attrs:function(){for(var t=0;t<m.length;t++)if(m[t].type==this.node.type)return m[t].attrs;return[]},otherValue:function(){return{type:this.type}}},data:function(){return{otherAttrs:[{name:"type",title:"选中类型",type:"select",option:[{value:"line",label:"线"},{value:"node",label:"节点"}],disabled:!0}]}},methods:{deleteActive:function(){this.$emit("deleteActive")}}},N={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node-attr"},[n("el-tabs",{staticClass:"node-attr-content",attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:"属性设置"}},[n("form-auto",{attrs:{form:t.otherValue,attrs:t.otherAttrs}}),t._v(" "),"node"==t.type?n("form-auto",{attrs:{form:t.node,attrs:t.attrs}}):t._e(),t._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.deleteActive}},[t._v("删除选中")])],1)],1)],1)},staticRenderFns:[]};var S={mixins:[{data:function(){return{jsplumbSetting:{Anchors:["Top","TopCenter","TopRight","TopLeft","Right","RightMiddle","Bottom","BottomCenter","BottomRight","BottomLeft","Left","LeftMiddle"],Container:"panelRef",Connector:["Bezier",{curviness:100}],ConnectionsDetachable:!1,DeleteEndpointsOnDetach:!1,Endpoint:["Blank",{Overlays:""}],EndpointStyle:{fill:"#1879ffa1",outlineWidth:1},LogEnabled:!0,PaintStyle:{stroke:"#E0E3E7",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},DragOptions:{cursor:"pointer",zIndex:2e3},Overlays:[["Arrow",{width:10,length:8,location:1,direction:1,foldback:.623}],["Label",{label:"",location:.1,cssClass:"aLabel"}]],RenderMode:"svg",HoverPaintStyle:{stroke:"#b0b2b5",strokeWidth:1},Scope:"jsPlumb_DefaultScope"},jsplumbConnectOptions:{isSource:!0,isTarget:!0,anchor:"Continuous",labelStyle:{cssClass:"flowLabel"},emptyLabelStyle:{cssClass:"emptyFlowLabel"}},jsplumbSourceOptions:{filter:".node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,maxConnections:-1,onMaxConnections:function(t,e){console.log("超过了最大值连线: "+t.maxConnections)}},jsplumbSourceOptions2:{filter:".node-drag",filterExclude:!1,allowLoopback:!0,connector:["Flowchart",{curviness:50}],connectorStyle:{stroke:"red",strokeWidth:1,outlineStroke:"transparent",outlineWidth:10},connectorHoverStyle:{stroke:"red",strokeWidth:2}},jsplumbTargetOptions:{filter:".node-drag",filterExclude:!1,anchor:"Continuous",allowLoopback:!0,dropOptions:{hoverClass:"ef-drop-hover"}}}}}],components:{NodeMenu:y,NodeItem:C,NodeAttr:n("VU/8")(x,N,!1,function(t){n("skoR")},"data-v-72667520",null).exports},data:function(){return{jsPlumb:null,data:{nodeList:[],lineList:[]},loadLineFinished:!1,activeNode:{},activeLine:{},activeType:"",attrShow:!1,mouseX:0,mouseY:0}},mounted:function(){this.jsPlumb=jsPlumb.getInstance(),this.init()},methods:{initData:function(){var t=h(),e=h(),n=h();this.data.nodeList.push({id:t,name:"新增节点1",left:"20px",top:"20px"}),this.data.nodeList.push({id:e,name:"新增节点2",left:"160px",top:"100px"}),this.data.nodeList.push({id:n,name:"新增节点3",left:"220px",top:"320px"}),this.data.lineList.push({from:t,to:n})},init:function(){var t=this;console.log("init start"),this.jsPlumb.ready(function(){console.log("this.jsPlumb ready"),t.jsPlumb.importDefaults(t.jsplumbSetting),t.jsPlumb.setContainer("panel-div-id"),t.$nextTick(function(){t.loadNode(),t.loadLine()}),t.jsPlumb.bind("click",function(e,n){console.log("click ",e),t.activeType="line",t.activeLine={from:e.sourceId,to:e.targetId}}),t.jsPlumb.bind("connection",function(e){var n=e.source.id,i=e.target.id;t.loadLineFinished&&t.data.lineList.push({from:n,to:i})}),t.jsPlumb.bind("connectionDetached",function(e){console.log("删除连线",e);for(var n=0;n<t.data.lineList.length;n++)if(t.data.lineList[n].from==e.sourceId&&t.data.lineList[n].to==e.targetId){t.data.lineList.splice(n,1);break}}),t.jsPlumb.bind("contextmenu",function(t){console.log("连线右击",t)}),t.jsPlumb.bind("beforeDrop",function(e){return e.sourceId===e.targetId?(t.$message.warning("节点不能自连接"),!1):(console.log("连线前",e),!0)})})},loadNode:function(){for(var t=0;t<this.data.nodeList.length;t++){var e=this.data.nodeList[t];console.log("node=",e),this.jsPlumb.makeSource(e.id,this.jsplumbTargetOptions),this.jsPlumb.makeTarget(e.id,this.jsplumbTargetOptions),this.jsPlumb.draggable(e.id,{containment:"parent",stop:function(t){console.log("拖拽结束: ",t)}})}},loadLine:function(){for(var t=this,e=0;e<this.data.lineList.length;e++){var n=this.data.lineList[e],i={source:n.from,target:n.to};this.jsPlumb.connect(i,this.jsplumbConnectOptions)}this.$nextTick(function(){t.loadLineFinished=!0})},addNode:function(t,e){var n=this;console.log("addNode start");var i=t.originalEvent.clientX,o=t.originalEvent.clientY,a=this.$refs.panelRef,s=a.getBoundingClientRect();if(!(i<s.x||i>s.width+s.x||o<s.y||s.y>s.y+s.height)){i=i-s.x+a.scrollLeft,o=o-s.y+a.scrollTop,i-=e.width/2,o-=e.height/2,i<0&&(i=0),o<0&&(o=0),console.log("left=",i,"top=",o);var l=v(e);l.left=i+"px",l.top=o+"px",this.data.nodeList.push(l),this.$nextTick(function(){n.jsPlumb.makeSource(l.id,n.jsplumbTargetOptions),n.jsPlumb.makeTarget(l.id,n.jsplumbTargetOptions),n.jsPlumb.draggable(l.id,{containment:"parent",stop:function(t){console.log("拖拽结束: ",t)}})})}},changeNodePostion:function(t){for(var e=0;e<this.data.nodeList.length;e++){var n=this.data.nodeList[e];if(n.id==t.nodeId){if(n.left==t.left&&n.top==t.top)return;n.left=t.left,n.top=t.top}}},nodeClick:function(t){console.log("active",t),this.activeType="node",this.activeNode=t},deleteActive:function(){var t=this;if("line"==this.activeType){var e=this.jsPlumb.getConnections({source:this.activeLine.from,target:this.activeLine.to})[0];this.jsPlumb.deleteConnection(e),this.activeLine={}}else if("node"==this.activeType)for(var n=0;n<this.data.nodeList.length;n++)if(this.data.nodeList[n].id==this.activeNode.id){this.data.nodeList.splice(n,1),this.$nextTick(function(){t.jsPlumb.removeAllEndpoints(t.activeNode.id),t.activeNode={}});break}}}},T={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main-panel"},[n("div",{staticClass:"node-menu-div"},[n("node-menu",{on:{addNode:t.addNode}})],1),t._v(" "),n("div",{ref:"panelRef",staticClass:"panel-div",attrs:{id:"panel-div-id"}},[t._v("\n    "+t._s(t.data)+"\n    "),t._l(t.data.nodeList,function(e){return n("node-item",{key:e.id,class:{"active-node-item":"node"==t.activeType&&e.id==t.activeNode.id},attrs:{id:e.id,node:e},on:{nodeClick:t.nodeClick,changeNodePostion:t.changeNodePostion}})})],2),t._v(" "),n("node-attr",{attrs:{node:t.activeNode,line:t.activeLine,type:t.activeType},on:{deleteActive:t.deleteActive}})],1)},staticRenderFns:[]};var w=n("VU/8")(S,T,!1,function(t){n("6l73")},"data-v-50f287d8",null).exports;i.default.use(s.a);var R=new s.a({routes:[{path:"/hello",name:"HelloWorld",component:d},{path:"/",name:"MainPanel",component:w}]}),E=n("3eaK"),$=n.n(E),O=n("zL8q"),A=n.n(O);n("tvR6");i.default.use(A.a),i.default.config.productionTip=!1,i.default.prototype.$jsPlumb=$.a.jsPlumb,new i.default({el:"#app",router:R,components:{App:a},template:"<App/>"})},UUFZ:function(t,e){},skoR:function(t,e){},tvR6:function(t,e){},uLYZ:function(t,e){},uaGJ:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.694fe2f3f2acfdf78763.js.map